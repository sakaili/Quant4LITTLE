# Makerè®¢å•æ‰§è¡Œç­–ç•¥è¯´æ˜

## ğŸ“Š ä»€ä¹ˆæ˜¯Maker vs Takerï¼Ÿ

### Taker (å¸‚ä»·å•)
- **å®šä¹‰**: ç«‹å³æˆäº¤çš„è®¢å•ï¼Œæ¶ˆè€—è®¢å•ç°¿æµåŠ¨æ€§
- **è´¹ç”¨**: é€šå¸¸æ”¯ä»˜0.04-0.05%
- **ä¼˜ç‚¹**: ç«‹å³æˆäº¤ï¼Œæ— ç­‰å¾…
- **ç¼ºç‚¹**: è´¹ç”¨é«˜ï¼Œæ»‘ç‚¹é£é™©

### Maker (é™ä»·å•)
- **å®šä¹‰**: æŒ‚å•ç­‰å¾…æˆäº¤ï¼Œæä¾›è®¢å•ç°¿æµåŠ¨æ€§
- **è´¹ç”¨**: é€šå¸¸è·å¾—0.02%è¿”ä½£æˆ–0è´¹ç”¨
- **ä¼˜ç‚¹**: èŠ‚çœè´¹ç”¨ï¼Œæœ‰è¿”ä½£
- **ç¼ºç‚¹**: å¯èƒ½ä¸æˆäº¤ï¼Œç­‰å¾…æ—¶é—´

### è´¹ç”¨å¯¹æ¯”ï¼ˆæ¯ç¬”äº¤æ˜“ï¼‰

| ç±»å‹ | å¼€ä»“è´¹ç”¨ | å¹³ä»“è´¹ç”¨ | å¾€è¿”è´¹ç”¨ | ç¤ºä¾‹(10000U) |
|------|---------|---------|---------|-------------|
| Taker | 0.05% | 0.05% | 0.10% | -10 USDT |
| Maker | -0.02% | -0.02% | -0.04% | +4 USDT |
| **å·®è·** | **0.07%** | **0.07%** | **0.14%** | **14 USDT** |

**ç»“è®º**: å¯¹äºç›®æ ‡æ”¶ç›Š5-10%çš„ç­–ç•¥ï¼Œ0.14%çš„è´¹ç”¨å·®è·éå¸¸é‡è¦ï¼

---

## ğŸ¯ åšç©ºç­–ç•¥çš„Makerè®¢å•é€»è¾‘

### å…¥åœºé€»è¾‘ï¼ˆåšç©ºå¼€ä»“ï¼‰

```
å½“å‰å¸‚åœºçŠ¶æ€:
  Bid (ä¹°1): 7.300 USDT
  Ask (å–1): 7.305 USDT
  Spread: 0.068%

Makerç­–ç•¥:
  â†’ åœ¨Askä¹‹ä¸ŠæŒ‚é™ä»·å–å•
  â†’ ä»·æ ¼: 7.305 * (1 + 0.05%) = 7.309 USDT
  â†’ ç­‰å¾…ä¹°å•åƒæˆ‘ä»¬çš„å–å•
  â†’ æˆ‘ä»¬æ˜¯Makerï¼Œå¯¹æ‰‹æ˜¯Taker

ç­‰å¾…æˆäº¤:
  âœ“ å¦‚æœä»·æ ¼ä¸Šæ¶¨åˆ°7.309ï¼Œè®¢å•æˆäº¤
  âœ— å¦‚æœä»·æ ¼ä¸‹è·Œï¼Œè¶…æ—¶å–æ¶ˆè®¢å•
```

**å…³é”®ç‚¹**:
1. ä»·æ ¼ç•¥é«˜äºå½“å‰Askï¼Œæ›´å®¹æ˜“æˆäº¤
2. é¿å…ç«‹å³æˆäº¤ï¼ˆé‚£æ ·å°±å˜æˆTakeräº†ï¼‰
3. å¦‚æœå¸‚åœºå¿«é€Ÿä¸‹è·Œï¼Œå¯èƒ½æ— æ³•æˆäº¤ï¼ˆè¿™åè€Œæ˜¯å¥½äº‹ï¼Œé¿å…äº†ä¸åˆ©å…¥åœºï¼‰

### å‡ºåœºé€»è¾‘ï¼ˆåšç©ºå¹³ä»“ï¼‰

```
5å¤©åå¸‚åœºçŠ¶æ€:
  Bid (ä¹°1): 6.500 USDT
  Ask (å–1): 6.505 USDT
  Spread: 0.077%

Makerç­–ç•¥:
  â†’ åœ¨Bidä¹‹ä¸‹æŒ‚é™ä»·ä¹°å•
  â†’ ä»·æ ¼: 6.500 * (1 - 0.05%) = 6.497 USDT
  â†’ ç­‰å¾…å–å•åƒæˆ‘ä»¬çš„ä¹°å•
  â†’ æˆ‘ä»¬æ˜¯Makerï¼Œå¯¹æ‰‹æ˜¯Taker

ç­‰å¾…æˆäº¤:
  âœ“ å¦‚æœä»·æ ¼ä¸‹è·Œåˆ°6.497ï¼Œè®¢å•æˆäº¤
  âœ— å¦‚æœä»·æ ¼ä¸Šæ¶¨ï¼Œè¶…æ—¶å–æ¶ˆè®¢å•
```

**å…³é”®ç‚¹**:
1. ä»·æ ¼ç•¥ä½äºå½“å‰Bidï¼Œæ›´å®¹æ˜“æˆäº¤
2. å¦‚æœå¸‚åœºå¿«é€Ÿä¸Šæ¶¨ï¼Œå¯èƒ½æ— æ³•æˆäº¤ï¼ˆè¿™æ—¶åº”è¯¥é‡æ–°è¯„ä¼°æ˜¯å¦é€€å‡ºï¼‰

---

## ğŸ’» ä»£ç å®ç°

### æ ¸å¿ƒç±»: MakerOrderExecutor

å·²åˆ›å»º [scripts/maker_order_utils.py](scripts/maker_order_utils.py) åŒ…å«å®Œæ•´å®ç°ã€‚

**ä¸»è¦åŠŸèƒ½**:

1. **get_orderbook()**: è·å–å®æ—¶ä¹°å–ç›˜å£
2. **calculate_maker_price()**: è®¡ç®—Makeré™ä»·
3. **place_maker_order()**: ä¸‹é™ä»·å•
4. **wait_for_fill()**: ç­‰å¾…æˆäº¤æˆ–è¶…æ—¶å–æ¶ˆ

### ä½¿ç”¨ç¤ºä¾‹

```python
from scripts.maker_order_utils import MakerOrderExecutor, execute_short_entry_maker, execute_short_exit_maker
import ccxt

# 1. åˆå§‹åŒ–äº¤æ˜“æ‰€
exchange = ccxt.binance({
    'apiKey': 'YOUR_API_KEY',
    'secret': 'YOUR_SECRET',
    'options': {'defaultType': 'future'}
})

# 2. åˆ›å»ºMakeræ‰§è¡Œå™¨
executor = MakerOrderExecutor(
    exchange=exchange,
    maker_offset_pct=0.05,   # ç¦»ç›˜å£0.05%
    max_wait_seconds=60,     # æœ€å¤šç­‰å¾…60ç§’
    check_interval=2.0       # æ¯2ç§’æ£€æŸ¥çŠ¶æ€
)

# 3. æ‰§è¡Œåšç©ºå…¥åœº
entry_order = execute_short_entry_maker(
    executor=executor,
    symbol='DEXE/USDT:USDT',
    amount=1.0
)

# 4. ç­‰å¾…5å¤©...

# 5. æ‰§è¡Œåšç©ºå‡ºåœº
exit_order = execute_short_exit_maker(
    executor=executor,
    symbol='DEXE/USDT:USDT',
    amount=1.0
)

# 6. è®¡ç®—æ”¶ç›Š
if entry_order and exit_order:
    entry_price = entry_order['average']
    exit_price = exit_order['average']
    pnl_pct = (entry_price - exit_price) / entry_price
    print(f"æ”¶ç›Š: {pnl_pct:.2%}")
```

---

## âš™ï¸ å‚æ•°é…ç½®

### maker_offset_pctï¼ˆç¦»ç›˜å£è·ç¦»ï¼‰

| æ•°å€¼ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|
| 0.01% | éå¸¸æ¿€è¿› | æµåŠ¨æ€§æé«˜çš„å¸ç§ |
| 0.05% | **æ¨è** | ä¸€èˆ¬æµåŠ¨æ€§å¸ç§ |
| 0.10% | ä¿å®ˆ | ä½æµåŠ¨æ€§åƒåœ¾å¸ |
| 0.20% | éå¸¸ä¿å®ˆ | æä½æµåŠ¨æ€§ |

**å»ºè®®**: å¯¹äºå200åä½æµåŠ¨æ€§å¸ç§ï¼Œä½¿ç”¨ **0.10-0.15%** æ›´åˆç†ã€‚

### max_wait_secondsï¼ˆæœ€é•¿ç­‰å¾…æ—¶é—´ï¼‰

| æ•°å€¼ | ç‰¹ç‚¹ | é£é™© |
|------|------|------|
| 30ç§’ | å¿«é€Ÿå†³ç­– | æˆäº¤ç‡ä½ |
| 60ç§’ | **æ¨è** | å¹³è¡¡ |
| 120ç§’ | è€å¿ƒç­‰å¾… | å¸‚åœºå˜åŒ–é£é™© |
| 300ç§’ | æåº¦è€å¿ƒ | ä»·æ ¼å¯èƒ½å¤§å¹…å˜åŠ¨ |

**å»ºè®®**: å¯¹äºæ¯å°æ—¶è¿è¡Œçš„ç­–ç•¥ï¼Œ60ç§’ç­‰å¾…æ˜¯åˆç†çš„ã€‚

---

## ğŸ”„ é›†æˆåˆ°ç°æœ‰ç³»ç»Ÿ

### æ–¹æ¡ˆ1: ä¿®æ”¹Paper Tradingä¸ºå®ç›˜æ‰§è¡Œ

åœ¨ [scripts/paper_trader.py](scripts/paper_trader.py) ä¸­æ·»åŠ å®ç›˜æ‰§è¡Œé€‰é¡¹:

```python
def run_paper_trading(date: str, use_real_execution: bool = False):
    """
    è¿è¡ŒPaper Tradingæˆ–å®ç›˜äº¤æ˜“

    Args:
        date: äº¤æ˜“æ—¥æœŸ
        use_real_execution: æ˜¯å¦çœŸå®ä¸‹å•
    """
    # ... ç°æœ‰é€»è¾‘ç”Ÿæˆä¿¡å· ...

    if use_real_execution:
        # å®ç›˜æ‰§è¡Œ
        from scripts.maker_order_utils import MakerOrderExecutor, execute_short_entry_maker
        executor = MakerOrderExecutor(...)

        for _, signal in signals.iterrows():
            execute_short_entry_maker(
                executor=executor,
                symbol=signal['symbol'],
                amount=calculate_position_size(signal)
            )
    else:
        # Paper Trading
        # ... ä¿å­˜ä¿¡å·åˆ°CSV ...
```

### æ–¹æ¡ˆ2: åˆ›å»ºç‹¬ç«‹çš„å®ç›˜æ‰§è¡Œè„šæœ¬

åˆ›å»º `scripts/live_trader_maker.py` è¯»å–Paper Tradingä¿¡å·å¹¶æ‰§è¡Œ:

```python
# ä¼ªä»£ç 
def main():
    # 1. è¯»å–ä»Šæ—¥Paper Tradingä¿¡å·
    signals = pd.read_csv('data/paper_trading/signals_20251123.csv')

    # 2. åˆ›å»ºMakeræ‰§è¡Œå™¨
    executor = MakerOrderExecutor(...)

    # 3. å¯¹æ¯ä¸ªä¿¡å·æ‰§è¡Œå…¥åœº
    for _, signal in signals.iterrows():
        execute_short_entry_maker(executor, signal['symbol'], amount)

    # 4. ç®¡ç†æŒä»“ï¼Œ5å¤©åæ‰§è¡Œå‡ºåœº
    # ...
```

---

## ğŸ“ˆ é¢„æœŸæ”¹è¿›

### è´¹ç”¨èŠ‚çœ

å‡è®¾æ¯å¤©äº¤æ˜“10ç¬”ï¼ˆå¾€è¿”20æ¬¡ä¸‹å•ï¼‰:

| é¡¹ç›® | Taker | Maker | æ”¹è¿› |
|------|-------|-------|------|
| å•ç¬”å¾€è¿”è´¹ç”¨ | 0.10% | -0.04% | +0.14% |
| æ¯æ—¥10ç¬” | -1.0% | +0.4% | **+1.4%** |
| æ¯æœˆ300ç¬” | -30% | +12% | **+42%** |

**ç»“è®º**: æ¯æœˆå¯èŠ‚çœæˆ–é¢å¤–è·å¾— **42%** çš„äº¤æ˜“æˆæœ¬ï¼

### èƒœç‡å½±å“

**Makerè®¢å•çš„éšæ€§ä¼˜åŠ¿**:
1. **ä»·æ ¼æ”¹å–„**: å…¥åœºä»·æ¯”å¸‚ä»·å¥½0.05-0.10%
2. **é¿å…ä¸åˆ©å…¥åœº**: å¦‚æœä»·æ ¼å¿«é€Ÿåå‘ï¼Œè®¢å•ä¸æˆäº¤ï¼ˆè‡ªç„¶è¿‡æ»¤ï¼‰
3. **æ›´å¥½çš„å‡ºåœºä»·**: å¹³ä»“ä»·ä¹Ÿæ¯”å¸‚ä»·å¥½0.05-0.10%

**ç»¼åˆæ•ˆæœ**: å®é™…æ”¶ç›Šç‡å¯èƒ½æå‡ **0.5-1.0%**

---

## âš ï¸ é£é™©ä¸é™åˆ¶

### 1. æˆäº¤ç‡é£é™©

**é—®é¢˜**: Makerè®¢å•å¯èƒ½ä¸æˆäº¤

**è§£å†³æ–¹æ¡ˆ**:
- è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼ˆ60ç§’ï¼‰
- è¶…æ—¶åé‡æ–°è¯„ä¼°ä¿¡å·æ˜¯å¦ä»ç„¶æœ‰æ•ˆ
- å¯ä»¥å›é€€åˆ°Takerè®¢å•ï¼ˆç´§æ€¥æƒ…å†µï¼‰

### 2. ä½æµåŠ¨æ€§é£é™©

**é—®é¢˜**: åƒåœ¾å¸æµåŠ¨æ€§å·®ï¼Œä¹°å–ä»·å·®å¤§

**è§£å†³æ–¹æ¡ˆ**:
- å¢å¤§maker_offset_pctåˆ°0.10-0.15%
- æ£€æŸ¥è®¢å•ç°¿æ·±åº¦ï¼Œé¿å…æ»‘ç‚¹
- é™åˆ¶å•ç¬”äº¤æ˜“é‡‘é¢

### 3. å¸‚åœºå¿«é€Ÿå˜åŠ¨

**é—®é¢˜**: ç­‰å¾…Makeræˆäº¤æ—¶ä»·æ ¼å¤§å¹…å˜åŠ¨

**è§£å†³æ–¹æ¡ˆ**:
- è®¾ç½®æ­¢æŸé€»è¾‘
- ç›‘æ§æŒä»“ç›ˆäº
- å¿«é€Ÿå¸‚åœºç”¨Takerï¼Œæ…¢é€Ÿå¸‚åœºç”¨Maker

---

## ğŸ¯ æ¨èç­–ç•¥

### å¯¹äºä½ çš„åƒåœ¾å¸åšç©ºç­–ç•¥

**å…¥åœº**:
```python
executor = MakerOrderExecutor(
    maker_offset_pct=0.10,  # åƒåœ¾å¸æµåŠ¨æ€§å·®ï¼Œç”¨0.10%
    max_wait_seconds=60,    # ç­‰å¾…60ç§’
    check_interval=2.0
)
```

**å‡ºåœº**:
- 5å¤©åä¼˜å…ˆä½¿ç”¨Maker
- å¦‚æœæœªæˆäº¤ï¼Œç­‰å¾…ä¸‹ä¸€ä¸ªå°æ—¶å‘¨æœŸ
- ç´§æ€¥æƒ…å†µï¼ˆå¤§å¹…äºæŸï¼‰ä½¿ç”¨Takerç«‹å³æ­¢æŸ

**Position Size**:
- æ¯ä¸ªä¿¡å·ä¸è¶…è¿‡è´¦æˆ·çš„1-2%
- é¿å…å•å¸ç§è¿‡åº¦é›†ä¸­

---

## ğŸ“Š ç›‘æ§æŒ‡æ ‡

### æ–°å¢ç»Ÿè®¡å­—æ®µ

åœ¨ `data/backtest_trades.csv` ä¸­æ·»åŠ :

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `entry_order_type` | å…¥åœºè®¢å•ç±»å‹(maker/taker) |
| `exit_order_type` | å‡ºåœºè®¢å•ç±»å‹(maker/taker) |
| `entry_wait_time` | å…¥åœºç­‰å¾…æ—¶é—´(ç§’) |
| `exit_wait_time` | å‡ºåœºç­‰å¾…æ—¶é—´(ç§’) |
| `maker_rebate` | Makerè¿”ä½£é‡‘é¢ |
| `total_fee` | æ€»è´¹ç”¨ |

### Dashboardç»Ÿè®¡

åœ¨ [scripts/dashboard.py](scripts/dashboard.py) ä¸­æ·»åŠ :

```python
def show_execution_statistics():
    """æ˜¾ç¤ºè®¢å•æ‰§è¡Œç»Ÿè®¡"""
    trades = pd.read_csv('data/backtest_trades.csv')

    maker_entry_pct = (trades['entry_order_type'] == 'maker').sum() / len(trades)
    maker_exit_pct = (trades['exit_order_type'] == 'maker').sum() / len(trades)

    avg_fee_pct = trades['total_fee'].mean()

    print(f"Makerå…¥åœºæˆäº¤ç‡: {maker_entry_pct:.1%}")
    print(f"Makerå‡ºåœºæˆäº¤ç‡: {maker_exit_pct:.1%}")
    print(f"å¹³å‡è´¹ç”¨: {avg_fee_pct:.3%}")
```

---

## ğŸš€ å®æ–½æ­¥éª¤

### é˜¶æ®µ1: æµ‹è¯•ç½‘éªŒè¯ï¼ˆ1-2å¤©ï¼‰

1. ä½¿ç”¨Binanceæµ‹è¯•ç½‘
2. è¿è¡Œå°è§„æ¨¡æµ‹è¯•
3. éªŒè¯Makerè®¢å•é€»è¾‘æ­£ç¡®

### é˜¶æ®µ2: å°èµ„é‡‘å®ç›˜ï¼ˆ1å‘¨ï¼‰

1. ä½¿ç”¨100-500 USDT
2. æ¯å°æ—¶ç”Ÿæˆ1-2ä¸ªä¿¡å·
3. ç»Ÿè®¡Makeræˆäº¤ç‡

### é˜¶æ®µ3: é€æ­¥æ‰©å¤§ï¼ˆ1ä¸ªæœˆï¼‰

1. æ ¹æ®æˆäº¤ç‡è°ƒæ•´å‚æ•°
2. ä¼˜åŒ–maker_offset_pct
3. å®Œå–„æ­¢æŸé€»è¾‘

### é˜¶æ®µ4: å…¨é¢è¿è¡Œ

1. åˆ‡æ¢åˆ°å®Œæ•´ç­–ç•¥
2. æ¯å°æ—¶20ä¸ªä¿¡å·
3. æŒç»­ç›‘æ§ä¼˜åŒ–

---

## ğŸ“ æ€»ç»“

**Makerè®¢å•çš„ä¼˜åŠ¿**:
- âœ… èŠ‚çœè´¹ç”¨ 0.14%/å¾€è¿”
- âœ… ä»·æ ¼æ”¹å–„ 0.05-0.10%
- âœ… è‡ªç„¶è¿‡æ»¤ä¸åˆ©å…¥åœº
- âœ… é€‚åˆä¸­ä½é¢‘ç­–ç•¥

**é€‚ç”¨åœºæ™¯**:
- âœ… æ¯å°æ—¶1æ¬¡çš„ç­–ç•¥ï¼ˆä½ çš„åœºæ™¯ï¼‰
- âœ… æŒä»“å‘¨æœŸ5å¤©
- âœ… å¯ä»¥ç­‰å¾…60ç§’æˆäº¤
- âœ… ä¸éœ€è¦æé€Ÿå…¥åœº

**å®æ–½å»ºè®®**:
1. å…ˆåœ¨æµ‹è¯•ç½‘éªŒè¯
2. å°èµ„é‡‘å®ç›˜æµ‹è¯•
3. ç»Ÿè®¡æˆäº¤ç‡è°ƒä¼˜
4. é€æ­¥æ‰©å¤§è§„æ¨¡

---

ç›¸å…³æ–‡æ¡£:
- [QUICK_START.md](QUICK_START.md) - å¿«é€Ÿå¯åŠ¨æŒ‡å—
- [ENHANCED_SYSTEM.md](ENHANCED_SYSTEM.md) - å¢å¼ºç‰ˆç³»ç»Ÿè¯´æ˜
- [scripts/maker_order_utils.py](scripts/maker_order_utils.py) - Makerè®¢å•å·¥å…·
